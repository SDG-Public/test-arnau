{
	"name": "DF_SANFER_ODS_FACT_EXPEDIENT",
	"properties": {
		"folder": {
			"name": "SANFER"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "STG_SANFER_FACT_EXPEDIENT",
						"type": "DatasetReference"
					},
					"name": "STGFactExpedient"
				},
				{
					"dataset": {
						"referenceName": "DM_SANFER_DIM_VALORS",
						"type": "DatasetReference"
					},
					"name": "DMDimValors"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ODS_SANFER_FACT_EXPEDIENT",
						"type": "DatasetReference"
					},
					"name": "ODSFactExpedient"
				},
				{
					"dataset": {
						"referenceName": "ODS_SANFER_FACT_EXPEDIENT",
						"type": "DatasetReference"
					},
					"name": "ODSFactExpedient1"
				}
			],
			"transformations": [
				{
					"name": "AddDataInsercio"
				},
				{
					"name": "RenombrarCampos"
				},
				{
					"name": "FiltrarCamposUtiles"
				},
				{
					"name": "CambioFlag01"
				},
				{
					"name": "Join1"
				},
				{
					"name": "FilterInsert"
				},
				{
					"name": "FilterUpdate"
				},
				{
					"name": "RenombrarCampos2"
				},
				{
					"name": "CambioFlag02"
				},
				{
					"name": "join2"
				},
				{
					"name": "FiltrarCamposUtiles1"
				},
				{
					"name": "AddDataInsercio1"
				},
				{
					"name": "alterRow1"
				}
			],
			"script": "parameters{\n\tP_DATA_FI as string,\n\tP_DATA_MODIF as string,\n\tP_DATA_ALTA as string\n}\nsource(output(\n\t\tCODINT_EXP as decimal(7,0),\n\t\tNUM_EXPEDIENT as string,\n\t\tCODI_TIPEX as string,\n\t\tCODI_ESTAT as string,\n\t\tTEMA as string,\n\t\tADRECA as string,\n\t\tOBSERVACIONS as string,\n\t\tREFEXT as string,\n\t\tREFINT as string,\n\t\tDATA_INI_TERMINI as timestamp,\n\t\tDATA_FI_TERMINI as timestamp,\n\t\tUSUARI_ALTA as string,\n\t\tDATA_ALTA_SISTEMA as timestamp,\n\t\tUSUARI_DARRERA_MODIF as string,\n\t\tDATA_DARRERA_MODIF as timestamp,\n\t\tIND_BAIXA as string,\n\t\tMOTIU_BAIXA as string,\n\t\tDATA_BAIXA as timestamp,\n\t\tVERSION as double,\n\t\tCODI_FRANJA as decimal(4,0),\n\t\tCAPSA_ARXIVAT as string,\n\t\tUTM_X as string,\n\t\tUTM_Y as string,\n\t\tID_EXP_REL as decimal(7,0),\n\t\tCONTADOR as decimal(8,0),\n\t\tDEMARCACIO as decimal(4,0),\n\t\tID_TECNIC as decimal(10,0),\n\t\tDATA_INI_AUTORITZACIO as timestamp,\n\t\tDATA_FI_AUTORITZACIO as timestamp,\n\t\tNUM_ARXIVADOR_INI as string,\n\t\tNUM_ARXIVADOR_FI as string,\n\t\tPRORROGABLE as decimal(1,0),\n\t\tFORMAT as string,\n\t\tSUPERFICIE_OCUPADA as decimal(10,2),\n\t\tTIPUS_DENUNCIA as double,\n\t\tDATA_DENUNCIA as timestamp,\n\t\tHORA_DENUNCIA as string,\n\t\tDATA_INFRACCIO as timestamp,\n\t\tDATA_FI_INFRACCIO as timestamp,\n\t\tCODI_DENUNCIA as string,\n\t\tLINIA as string,\n\t\tTREN as string,\n\t\tESTACIO as string,\n\t\tTRAJECTE as string,\n\t\tTIPUS_DENUNCIANT as double,\n\t\tID_PERSONA_DENUNCIANT as string,\n\t\tDATA_AI as timestamp,\n\t\tDATA_CADUCITAT as timestamp,\n\t\tDATA_NOTIFICACIO_AI as timestamp,\n\t\tTIPUS_NOTIFICACIO_AI as double,\n\t\tDATA_RESOLUCIO as timestamp,\n\t\tDATA_NOTIFICACIO_RESOLUCIO as timestamp,\n\t\tDATA_PRESCRIPCIO as timestamp,\n\t\tIMPORT_SANCIO as decimal(13,2),\n\t\tID_CAUSA as decimal(10,0),\n\t\tBAREM_PRIMERA_QUALIFICACIO as decimal(10,0),\n\t\tBAREM_ULTIMA_QUALIFICACIO as decimal(10,0),\n\t\tDESC_ULTIMA_QUALIFICACIO as string,\n\t\tID_ORGANITZACIO as double,\n\t\tTOTAL_PAGAT as decimal(10,2),\n\t\tFRACCIONAMENT as string,\n\t\tDEVOLUCIO as string,\n\t\tDATA_ESTAT as timestamp,\n\t\tID_EXP_TST as decimal(10,0),\n\t\tIND_TE_ALEGACIONS as string,\n\t\tID_VAL_INSTRUCTOR as double,\n\t\tDESC_ALEGACIO_PRESENTAT as string,\n\t\tDESC_ALEGACIO_RESPOSTA as string,\n\t\tID_MOTIU_ARXIU as double,\n\t\tIND_CATALA as string,\n\t\tDESC_INFORME_SJ as string,\n\t\tDESC_INFORME_ST as string,\n\t\tID_VAL_INSTRUCTOR_RECURS as double,\n\t\tID_SENTIT_RECURS as double,\n\t\tIMPORT_SANCIO_FERMA as decimal(13,2),\n\t\tDATA_NOTIFICACIO_REC as timestamp,\n\t\tTIPUS_NOTIFICACIO_REC as double,\n\t\tTIPUS_NOTIFICACIO_RESOLUCIO as double,\n\t\tESTAT_CONSTRENYIMENT as double,\n\t\tIND_REINCIDENT_FGC as string,\n\t\tIND_PAGAT_FGC as string,\n\t\tIND_DEVOLUCIO_TRAMITADA as string,\n\t\tDATA_NOTIFICACIO_REVISIO as timestamp,\n\t\tDATA_NOTIFICACIO_REVOCACIO_RES as timestamp,\n\t\tDATA_NOTIFICACIO_REVOCACIO_REC as timestamp,\n\t\tTIPUS_NOTIFICACIO_REVISIO as double,\n\t\tTIPUS_NOTIFICACIO_REV_RES as double,\n\t\tTIPUS_NOTIFICACIO_REV_REC as double,\n\t\tOPCIO_DECLARACIO as string,\n\t\tDATA_NOTIFICACIO_AU as timestamp,\n\t\tDATA_NOTIFICACIO_PR as timestamp,\n\t\tDATA_NOTIFICACIO_RDV as timestamp,\n\t\tTIPUS_NOTIFICACIO_AU as double,\n\t\tTIPUS_NOTIFICACIO_PR as double,\n\t\tTIPUS_NOTIFICACIO_RDV as double\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> STGFactExpedient\nsource(output(\n\t\tID_VALOR as double,\n\t\tDESC_VALOR as string,\n\t\tDESC_VALOR_COMPLETA as string,\n\t\tDESC_TIPUS_VALOR as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> DMDimValors\nFiltrarCamposUtiles derive(DATA_INSERCIO = currentDate()) ~> AddDataInsercio\nFilterInsert select(mapColumn(\n\t\tID_EXPEDIENT = CODINT_EXP,\n\t\tID_TECNIC,\n\t\tID_PERSONA_DENUNCIANT,\n\t\tID_TIPUS_DENUNCIANT = TIPUS_DENUNCIANT,\n\t\tID_CAUSA,\n\t\tID_ORGANITZACIO,\n\t\tID_MOTIU_ARXIU,\n\t\tID_BAREM_PRIMERA_QUALIFICACIO = BAREM_PRIMERA_QUALIFICACIO,\n\t\tID_BAREM_ULTIMA_QUALIFICACIO = BAREM_ULTIMA_QUALIFICACIO,\n\t\tID_TIPUS_NOTIFICACIO_REVISIO = TIPUS_NOTIFICACIO_REVISIO,\n\t\tID_EXPEDIENT_TST = ID_EXP_TST,\n\t\tID_TIPUS_NOTIFICACIO_AI = TIPUS_NOTIFICACIO_AI,\n\t\tID_TIPUS_NOTIFICACIO_RDV = TIPUS_NOTIFICACIO_RDV,\n\t\tID_TIPUS_NOTIFICACIO_AUTORITZACIO = TIPUS_NOTIFICACIO_AU,\n\t\tID_TIPUS_NOTIFICACIO_PRESCRIPCIO = TIPUS_NOTIFICACIO_PR,\n\t\tID_TIPUS_NOTIFICACIO_RECURS = TIPUS_NOTIFICACIO_REC,\n\t\tID_TIPUS_NOTIFICACIO_REVISIO_RECURS = TIPUS_NOTIFICACIO_REV_REC,\n\t\tID_TIPUS_NOTIFICACIO_RESOLUCIO = TIPUS_NOTIFICACIO_RESOLUCIO,\n\t\tID_TIPUS_NOTIFICACIO_REVISIO_RESOLUCIO = TIPUS_NOTIFICACIO_REV_RES,\n\t\tID_VALOR_INSTRUCTOR = ID_VAL_INSTRUCTOR,\n\t\tID_VALOR_INSTRUCTOR_RECURS = ID_VAL_INSTRUCTOR_RECURS,\n\t\tID_SENTIT_RECURS,\n\t\tID_ESTAT_CONSTRENYIMENT = ESTAT_CONSTRENYIMENT,\n\t\tID_OPCIO_DECLARACIO = OPCIO_DECLARACIO,\n\t\tCOD_DENUNCIA = CODI_DENUNCIA,\n\t\tCOD_TIPEX = CODI_TIPEX,\n\t\tCOD_ESTAT = CODI_ESTAT,\n\t\tCOD_USUARI_ALTA = USUARI_ALTA,\n\t\tCOD_USUARI_DARRERA_MODIF = USUARI_DARRERA_MODIF,\n\t\tNUM_EXPEDIENT,\n\t\tNUM_VERSIO = VERSION,\n\t\tNUM_CONTADOR = CONTADOR,\n\t\tIMP_SANCIO = IMPORT_SANCIO,\n\t\tIMP_SANCIO_FERMA = IMPORT_SANCIO_FERMA,\n\t\tIMP_TOTAL_PAGAT = TOTAL_PAGAT,\n\t\tDESC_TEMA = TEMA,\n\t\tDESC_OBSERVACIONS = OBSERVACIONS,\n\t\tDESC_LINIA = LINIA,\n\t\tDESC_TREN = TREN,\n\t\tDESC_ESTACIO = ESTACIO,\n\t\tDESC_TRAJECTE = TRAJECTE,\n\t\tDESC_INFORME_SJ,\n\t\tDESC_INFORME_ST,\n\t\tDESC_ULTIMA_QUALIFICACIO,\n\t\tDESC_ALEGACIO_PRESENTAT,\n\t\tDESC_ALEGACIO_RESPOSTA,\n\t\tDATA_ALTA_SISTEMA,\n\t\tDATA_DARRERA_MODIF,\n\t\tDATA_DENUNCIA,\n\t\tDATA_HORA_DENUNCIA = HORA_DENUNCIA,\n\t\tDATA_INFRACCIO,\n\t\tDATA_CADUCITAT,\n\t\tDATA_PRESCRIPCIO,\n\t\tDATA_ESTAT,\n\t\tDATA_NOTIFICACIO_AI,\n\t\tDATA_NOTIFICACIO_RDV,\n\t\tDATA_NOTIFICACIO_AUTORITZACIO = DATA_NOTIFICACIO_AU,\n\t\tDATA_NOTIFICACIO_PRESCRIPCIO = DATA_NOTIFICACIO_PR,\n\t\tDATA_NOTIFICACIO_REVISIO,\n\t\tDATA_NOTIFICACIO_RESOLUCIO,\n\t\tDATA_NOTIFICACIO_REVOCACIO_RESOLUCIO = DATA_NOTIFICACIO_REVOCACIO_RES,\n\t\tDATA_NOTIFICACIO_RECURS = DATA_NOTIFICACIO_REC,\n\t\tDATA_NOTIFICACIO_REVOCACIO_RECURS = DATA_NOTIFICACIO_REVOCACIO_REC,\n\t\tFLAG_BAIXA = IND_BAIXA,\n\t\tFLAG_DEVOLUCIO_TRAMITADA = IND_DEVOLUCIO_TRAMITADA,\n\t\tFLAG_PAGAT_FGC = IND_PAGAT_FGC,\n\t\tFLAG_ALEGACIONS = IND_TE_ALEGACIONS,\n\t\tFLAG_CATALA = IND_CATALA,\n\t\tDESC_MOTIU_BAIXA = MOTIU_BAIXA\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> RenombrarCampos\nJoin1 select(mapColumn(\n\t\tID_EXPEDIENT,\n\t\tID_PERSONA_DENUNCIANT,\n\t\tID_EXPEDIENT_TST,\n\t\tID_VALOR_INSTRUCTOR,\n\t\tCOD_DENUNCIA,\n\t\tCOD_TIPEX,\n\t\tCOD_ESTAT,\n\t\tCOD_USUARI_ALTA,\n\t\tCOD_USUARI_DARRERA_MODIF,\n\t\tNUM_EXPEDIENT,\n\t\tIMP_SANCIO,\n\t\tIMP_SANCIO_FERMA,\n\t\tIMP_TOTAL_PAGAT,\n\t\tDESC_TEMA,\n\t\tDESC_LINIA,\n\t\tDESC_TREN,\n\t\tDESC_ESTACIO,\n\t\tDESC_TRAJECTE,\n\t\tDESC_INFORME_SJ,\n\t\tDESC_INFORME_ST,\n\t\tDESC_ULTIMA_QUALIFICACIO,\n\t\tDESC_MOTIU_ARXIU = DESC_VALOR,\n\t\tDATA_NOTIFICACIO_AI,\n\t\tDATA_NOTIFICACIO_RESOLUCIO,\n\t\tDATA_DENUNCIA,\n\t\tDATA_INFRACCIO,\n\t\tDATA_PRESCRIPCIO,\n\t\tDATA_ESTAT,\n\t\tDATA_ALTA_SISTEMA,\n\t\tDATA_DARRERA_MODIF,\n\t\tFLAG_BAIXA,\n\t\tFLAG_DEVOLUCIO_TRAMITADA,\n\t\tFLAG_PAGAT_FGC,\n\t\tFLAG_ALEGACIONS,\n\t\tFLAG_CATALA\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FiltrarCamposUtiles\nRenombrarCampos derive(FLAG_CATALA = iif(FLAG_CATALA=='T', toInteger(1), toInteger(0)),\n\t\tFLAG_ALEGACIONS = iif(FLAG_ALEGACIONS=='T', toInteger(1), toInteger(0)),\n\t\tFLAG_PAGAT_FGC = iif(FLAG_PAGAT_FGC=='T', toInteger(1), toInteger(0)),\n\t\tFLAG_DEVOLUCIO_TRAMITADA = iif(FLAG_DEVOLUCIO_TRAMITADA=='T', toInteger(1), toInteger(0)),\n\t\tFLAG_BAIXA = iif(FLAG_BAIXA=='T', toInteger(1), toInteger(0))) ~> CambioFlag01\nCambioFlag01, DMDimValors join(ID_MOTIU_ARXIU == ID_VALOR,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> Join1\nSTGFactExpedient filter(DATA_ALTA_SISTEMA >= toTimestamp($P_DATA_ALTA) && DATA_ALTA_SISTEMA < toTimestamp($P_DATA_FI)) ~> FilterInsert\nSTGFactExpedient filter(DATA_DARRERA_MODIF >= toTimestamp($P_DATA_MODIF) && DATA_DARRERA_MODIF < toTimestamp($P_DATA_FI)) ~> FilterUpdate\nFilterUpdate select(mapColumn(\n\t\tID_EXPEDIENT = CODINT_EXP,\n\t\tID_TECNIC,\n\t\tID_PERSONA_DENUNCIANT,\n\t\tID_TIPUS_DENUNCIANT = TIPUS_DENUNCIANT,\n\t\tID_CAUSA,\n\t\tID_ORGANITZACIO,\n\t\tID_MOTIU_ARXIU,\n\t\tID_BAREM_PRIMERA_QUALIFICACIO = BAREM_PRIMERA_QUALIFICACIO,\n\t\tID_BAREM_ULTIMA_QUALIFICACIO = BAREM_ULTIMA_QUALIFICACIO,\n\t\tID_TIPUS_NOTIFICACIO_REVISIO = TIPUS_NOTIFICACIO_REVISIO,\n\t\tID_EXPEDIENT_TST = ID_EXP_TST,\n\t\tID_TIPUS_NOTIFICACIO_AI = TIPUS_NOTIFICACIO_AI,\n\t\tID_TIPUS_NOTIFICACIO_RDV = TIPUS_NOTIFICACIO_RDV,\n\t\tID_TIPUS_NOTIFICACIO_AUTORITZACIO = TIPUS_NOTIFICACIO_AU,\n\t\tID_TIPUS_NOTIFICACIO_PRESCRIPCIO = TIPUS_NOTIFICACIO_PR,\n\t\tID_TIPUS_NOTIFICACIO_RECURS = TIPUS_NOTIFICACIO_REC,\n\t\tID_TIPUS_NOTIFICACIO_REVISIO_RECURS = TIPUS_NOTIFICACIO_REV_REC,\n\t\tID_TIPUS_NOTIFICACIO_RESOLUCIO = TIPUS_NOTIFICACIO_RESOLUCIO,\n\t\tID_TIPUS_NOTIFICACIO_REVISIO_RESOLUCIO = TIPUS_NOTIFICACIO_REV_RES,\n\t\tID_VALOR_INSTRUCTOR = ID_VAL_INSTRUCTOR,\n\t\tID_VALOR_INSTRUCTOR_RECURS = ID_VAL_INSTRUCTOR_RECURS,\n\t\tID_SENTIT_RECURS,\n\t\tID_ESTAT_CONSTRENYIMENT = ESTAT_CONSTRENYIMENT,\n\t\tID_OPCIO_DECLARACIO = OPCIO_DECLARACIO,\n\t\tCOD_DENUNCIA = CODI_DENUNCIA,\n\t\tCOD_TIPEX = CODI_TIPEX,\n\t\tCOD_ESTAT = CODI_ESTAT,\n\t\tCOD_USUARI_ALTA = USUARI_ALTA,\n\t\tCOD_USUARI_DARRERA_MODIF = USUARI_DARRERA_MODIF,\n\t\tNUM_EXPEDIENT,\n\t\tNUM_VERSIO = VERSION,\n\t\tNUM_CONTADOR = CONTADOR,\n\t\tIMP_SANCIO = IMPORT_SANCIO,\n\t\tIMP_SANCIO_FERMA = IMPORT_SANCIO_FERMA,\n\t\tIMP_TOTAL_PAGAT = TOTAL_PAGAT,\n\t\tDESC_TEMA = TEMA,\n\t\tDESC_OBSERVACIONS = OBSERVACIONS,\n\t\tDESC_LINIA = LINIA,\n\t\tDESC_TREN = TREN,\n\t\tDESC_ESTACIO = ESTACIO,\n\t\tDESC_TRAJECTE = TRAJECTE,\n\t\tDESC_INFORME_SJ,\n\t\tDESC_INFORME_ST,\n\t\tDESC_ULTIMA_QUALIFICACIO,\n\t\tDESC_ALEGACIO_PRESENTAT,\n\t\tDESC_ALEGACIO_RESPOSTA,\n\t\tDATA_ALTA_SISTEMA,\n\t\tDATA_DARRERA_MODIF,\n\t\tDATA_DENUNCIA,\n\t\tDATA_HORA_DENUNCIA = HORA_DENUNCIA,\n\t\tDATA_INFRACCIO,\n\t\tDATA_CADUCITAT,\n\t\tDATA_PRESCRIPCIO,\n\t\tDATA_ESTAT,\n\t\tDATA_NOTIFICACIO_AI,\n\t\tDATA_NOTIFICACIO_RDV,\n\t\tDATA_NOTIFICACIO_AUTORITZACIO = DATA_NOTIFICACIO_AU,\n\t\tDATA_NOTIFICACIO_PRESCRIPCIO = DATA_NOTIFICACIO_PR,\n\t\tDATA_NOTIFICACIO_REVISIO,\n\t\tDATA_NOTIFICACIO_RESOLUCIO,\n\t\tDATA_NOTIFICACIO_REVOCACIO_RESOLUCIO = DATA_NOTIFICACIO_REVOCACIO_RES,\n\t\tDATA_NOTIFICACIO_RECURS = DATA_NOTIFICACIO_REC,\n\t\tDATA_NOTIFICACIO_REVOCACIO_RECURS = DATA_NOTIFICACIO_REVOCACIO_REC,\n\t\tFLAG_BAIXA = IND_BAIXA,\n\t\tFLAG_DEVOLUCIO_TRAMITADA = IND_DEVOLUCIO_TRAMITADA,\n\t\tFLAG_PAGAT_FGC = IND_PAGAT_FGC,\n\t\tFLAG_ALEGACIONS = IND_TE_ALEGACIONS,\n\t\tFLAG_CATALA = IND_CATALA,\n\t\tDESC_MOTIU_BAIXA = MOTIU_BAIXA\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> RenombrarCampos2\nRenombrarCampos2 derive(FLAG_CATALA = iif(FLAG_CATALA=='T', toInteger(1), toInteger(0)),\n\t\tFLAG_ALEGACIONS = iif(FLAG_ALEGACIONS=='T', toInteger(1), toInteger(0)),\n\t\tFLAG_PAGAT_FGC = iif(FLAG_PAGAT_FGC=='T', toInteger(1), toInteger(0)),\n\t\tFLAG_DEVOLUCIO_TRAMITADA = iif(FLAG_DEVOLUCIO_TRAMITADA=='T', toInteger(1), toInteger(0)),\n\t\tFLAG_BAIXA = iif(FLAG_BAIXA=='T', toInteger(1), toInteger(0))) ~> CambioFlag02\nCambioFlag02, DMDimValors join(ID_MOTIU_ARXIU == ID_VALOR,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> join2\njoin2 select(mapColumn(\n\t\tID_EXPEDIENT,\n\t\tID_PERSONA_DENUNCIANT,\n\t\tID_EXPEDIENT_TST,\n\t\tID_VALOR_INSTRUCTOR,\n\t\tCOD_DENUNCIA,\n\t\tCOD_TIPEX,\n\t\tCOD_ESTAT,\n\t\tCOD_USUARI_ALTA,\n\t\tCOD_USUARI_DARRERA_MODIF,\n\t\tNUM_EXPEDIENT,\n\t\tIMP_SANCIO,\n\t\tIMP_SANCIO_FERMA,\n\t\tIMP_TOTAL_PAGAT,\n\t\tDESC_TEMA,\n\t\tDESC_LINIA,\n\t\tDESC_TREN,\n\t\tDESC_ESTACIO,\n\t\tDESC_TRAJECTE,\n\t\tDESC_INFORME_SJ,\n\t\tDESC_INFORME_ST,\n\t\tDESC_ULTIMA_QUALIFICACIO,\n\t\tDESC_MOTIU_ARXIU = DESC_VALOR,\n\t\tDATA_NOTIFICACIO_AI,\n\t\tDATA_NOTIFICACIO_RESOLUCIO,\n\t\tDATA_DENUNCIA,\n\t\tDATA_INFRACCIO,\n\t\tDATA_PRESCRIPCIO,\n\t\tDATA_ESTAT,\n\t\tDATA_ALTA_SISTEMA,\n\t\tDATA_DARRERA_MODIF,\n\t\tFLAG_BAIXA,\n\t\tFLAG_DEVOLUCIO_TRAMITADA,\n\t\tFLAG_PAGAT_FGC,\n\t\tFLAG_ALEGACIONS,\n\t\tFLAG_CATALA\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FiltrarCamposUtiles1\nFiltrarCamposUtiles1 derive(DATA_INSERCIO = currentDate()) ~> AddDataInsercio1\nAddDataInsercio1 alterRow(updateIf(ID_EXPEDIENT==ID_EXPEDIENT)) ~> alterRow1\nAddDataInsercio sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tID_EXPEDIENT as decimal(7,0),\n\t\tID_PERSONA_DENUNCIANT as string,\n\t\tID_EXPEDIENT_TST as decimal(10,0),\n\t\tID_VALOR_INSTRUCTOR as double,\n\t\tCOD_DENUNCIA as string,\n\t\tCOD_TIPEX as string,\n\t\tCOD_ESTAT as string,\n\t\tCOD_USUARI_ALTA as string,\n\t\tCOD_USUARI_DARRERA_MODIF as string,\n\t\tNUM_EXPEDIENT as string,\n\t\tIMP_SANCIO as decimal(13,2),\n\t\tIMP_SANCIO_FERMA as decimal(13,2),\n\t\tIMP_TOTAL_PAGAT as decimal(10,2),\n\t\tDESC_TEMA as string,\n\t\tDESC_LINIA as string,\n\t\tDESC_TREN as string,\n\t\tDESC_ESTACIO as string,\n\t\tDESC_TRAJECTE as string,\n\t\tDESC_INFORME_SJ as string,\n\t\tDESC_INFORME_ST as string,\n\t\tDESC_ULTIMA_QUALIFICACIO as string,\n\t\tDESC_MOTIU_ARXIU as string,\n\t\tDATA_NOTIFICACIO_AI as timestamp,\n\t\tDATA_NOTIFICACIO_RESOLUCIO as timestamp,\n\t\tDATA_DENUNCIA as timestamp,\n\t\tDATA_INFRACCIO as timestamp,\n\t\tDATA_PRESCRIPCIO as timestamp,\n\t\tDATA_ESTAT as timestamp,\n\t\tDATA_ALTA_SISTEMA as timestamp,\n\t\tDATA_DARRERA_MODIF as timestamp,\n\t\tFLAG_BAIXA as integer,\n\t\tFLAG_DEVOLUCIO_TRAMITADA as integer,\n\t\tFLAG_PAGAT_FGC as integer,\n\t\tFLAG_ALEGACIONS as integer,\n\t\tFLAG_CATALA as integer,\n\t\tDATA_INSERCIO as date\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> ODSFactExpedient\nalterRow1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tID_EXPEDIENT as decimal(7,0),\n\t\tID_PERSONA_DENUNCIANT as string,\n\t\tID_EXPEDIENT_TST as decimal(10,0),\n\t\tID_VALOR_INSTRUCTOR as double,\n\t\tCOD_DENUNCIA as string,\n\t\tCOD_TIPEX as string,\n\t\tCOD_ESTAT as string,\n\t\tCOD_USUARI_ALTA as string,\n\t\tCOD_USUARI_DARRERA_MODIF as string,\n\t\tNUM_EXPEDIENT as string,\n\t\tIMP_SANCIO as decimal(13,2),\n\t\tIMP_SANCIO_FERMA as decimal(13,2),\n\t\tIMP_TOTAL_PAGAT as decimal(10,2),\n\t\tDESC_TEMA as string,\n\t\tDESC_LINIA as string,\n\t\tDESC_TREN as string,\n\t\tDESC_ESTACIO as string,\n\t\tDESC_TRAJECTE as string,\n\t\tDESC_INFORME_SJ as string,\n\t\tDESC_INFORME_ST as string,\n\t\tDESC_ULTIMA_QUALIFICACIO as string,\n\t\tDESC_MOTIU_ARXIU as string,\n\t\tDATA_NOTIFICACIO_AI as timestamp,\n\t\tDATA_NOTIFICACIO_RESOLUCIO as timestamp,\n\t\tDATA_DENUNCIA as timestamp,\n\t\tDATA_INFRACCIO as timestamp,\n\t\tDATA_PRESCRIPCIO as timestamp,\n\t\tDATA_ESTAT as timestamp,\n\t\tDATA_ALTA_SISTEMA as timestamp,\n\t\tDATA_DARRERA_MODIF as timestamp,\n\t\tFLAG_BAIXA as integer,\n\t\tFLAG_DEVOLUCIO_TRAMITADA as integer,\n\t\tFLAG_PAGAT_FGC as integer,\n\t\tFLAG_ALEGACIONS as integer,\n\t\tFLAG_CATALA as integer,\n\t\tDATA_INSERCIO as date\n\t),\n\tdeletable:false,\n\tinsertable:false,\n\tupdateable:true,\n\tupsertable:false,\n\tkeys:['ID_EXPEDIENT'],\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> ODSFactExpedient1"
		}
	}
}